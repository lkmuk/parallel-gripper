<?xml version="1.0"?>

<robot xmlns:xacro="http://www.ros.org/wiki/xacro">
    <!--the two "extra" joints lhs_j4 and rhs_j4 that closese the loop-->
    <!-- these are actually SDF not URDF-->
    <gazebo>
        <self_collide>true</self_collide>
    </gazebo>

    <gazebo>
        <joint name="lhs_j4" type="revolute"> <!--continuous joint not okay?-->
            <parent>lhs_claw</parent>
            <child>lhs_outer_beam</child>         
            <!--
                "pose" refers to where the j4 is on the child link 
                wrt to the CHILD link frame NOT the CAD frame!!
                This is quite different than URDF!

                For determining it correctly, use 
                roslaunch gripper_description inspect_gripper_rviz.launch focusOnJ4:=true
                observe the grid size (set to be 1 cm)
                (as always R-G-B stands for X-Y-Z)
                See `aid.png` for a screenshot!

                It's quite hard to automate this 
                (because it depends on how you define the mate connections in Onshape).
                In any case, the manual inspection takes almost no time. 
            -->
            <pose>0 -0.03 0</pose> <!--rod length-->
            <axis>
                <xyz>0 0 1</xyz>
            </axis>
        </joint>
    </gazebo>
    <gazebo>
        <joint name="rhs_j4" type="revolute">
            <parent>rhs_claw</parent>
            <child>rhs_outer_beam</child>         
            <!--see the remark for lhs_j4 -->
            <pose>0 0.03 0</pose>
            <axis>
                <xyz>0 0 -1</xyz>
            </axis>
        </joint>
    </gazebo>
    
    <!--the gearing connection between lhs_j1 and rhs_j1-->
    <gazebo>
        <joint name="j1_coupling" type="gearbox">
            <parent>lhs_inner_beam</parent>
            <child>rhs_inner_beam</child>
            <gearbox_ratio>1</gearbox_ratio>
            <gearbox_reference_body>base_link</gearbox_reference_body>
            <axis>
                <xyz>0 0 1</xyz>
            </axis>
            <axis2>
                <xyz>0 0 1</xyz>
            </axis2>
        </joint>
    </gazebo>
    
</robot>
